<!DOCTYPE html>
<html lang="ja">
    <meta charset="UTF-8">
    <head>
        <title>ゴルフアプリ</title>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/bxslider/4.2.12/jquery.bxslider.css">
        <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.4/css/all.css">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
        <script src="https://cdn.jsdelivr.net/bxslider/4.2.12/jquery.bxslider.min.js"></script>
        <link rel="stylesheet" href="index.css">

        <script>

            $(document).ready(function(){

              //  $('.modal_pop').hide();
              //  $('.slider').bxSlider({
              //      pager: false,
              //      controls: false,
              //      infiniteLoop: false,
              //      onSlideAfter: function($slideElement){
              //          if($slideElement.children("img").attr("rel") == "par3"){
              //              $('.modal_pop').fadeIn();
              //         }   
              //      }
              //  });
              //  $('.js-modal-close').on('click',function(){
              //      $('.modal_pop').fadeOut();
              //  })

            // protosureボタンの処理
            // $('#protosure_btn').click(function() {
            //     $.getJSON('https://zipcloud.ibsnet.co.jp/api/search?callback=?',
            //         {
            //             zipcode: $('#denominator').val()
            //         }
            // )
                
            //     .done(function(data) {
            //         if (!data.results) {
            //             alert('該当の住所がありません');
            //         } else {
            //             let result = data.results[0];
            //             $('#premium').val(result.address1);
            //         }
            //     }).fail(function(){
            //         alert('入力値を確認してください。');
            //     })
            // })

              const tenant_id = "05e16d6f-d4ff-4be4-b74b-0dc17b23281d";

            $("#protosure_btn").on("click", function(){
                $.ajax({
                  type: "PATCH",
                        url: "https://api-test-jp.protosure.io/public-api/" + tenant_id + "/quotes/6577fdb2-fc21-4a89-b921-19fa2826dd81/update_input_data/",
                        dataType : "json",
                        data: {
                            "inputData": {
                                "Name": "南本肇",
                                "Denominator": 10000
                            }
                        }
                }).done(function(data){
                    let id = data.id;
                    $('#quote_id').val(id);
                    $.ajax({
                        type: "PATCH",
                        url: "https://api-test-jp.protosure.io/public-api/" + tenant_id + "/quotes/6577fdb2-fc21-4a89-b921-19fa2826dd81/update_input_data/",
                        dataType : "json",
                        data: {
                            "inputData": {
                                "Name": "南本肇",
                                "Denominator": 10000
                            }
                        }
                    }).done(function(data){
                      let denominator = data.formData.Denominator;
                    $('#premium').val(denominator);

                    });

                }).fail(function(){
                    alert('入力値を確認してください。');
                });
            });




            // 住所検索ボタンを押すと外部apiを叩く処理が走る。
            $('#search_address_btn').click(function() {
                $.getJSON('https://zipcloud.ibsnet.co.jp/api/search?callback=?',
                    {
                        zipcode: $('#zip_code').val()
                    }
            )
                
                .done(function(data) {
                    if (!data.results) {
                        alert('該当の住所がありません');
                    } else {
                        let result = data.results[0];
                        $('#address1').val(result.address1);
                        $('#address2').val(result.address2);
                        $('#address3').val(result.address3);
                        $('#address4').val('This is the test.');
                    }
                }).fail(function(){
                    alert('入力値を確認してください。');
                })
            })

            // クリアボタンを押すと、フォームの中身がリセットされる。
            $('#search_clear_btn').click(function(){
                $('#zip_code').val('');
                $('#address1').val('');
                $('#address2').val('');
                $('#address3').val('');
                $('#address4').val('');
            })
            })

        </script>

          
    </head>

    <body>
        
      <div>
        <form method="post" action="#" style="width: fit-content; margin: 0 auto;">
          分母<br />
          <input type="text" name="denominator" style="width:100px" id="denominator">
          <input type="button" value="保険料見積" id="protosure_btn">
          <input type="button" value="クリア" id="search_clear_btn">
          <br />
          Quote_id<br />
          <input type="text" name="quote_id" style="width:500px" id="quote_id"><br />
          保険料<br />
          <input type="text" name="premium" style="width:500px" id="premium"><br />
          <br />
        </form>
      </div>



        <!-- <div class="slider">
            <div><img src="hole1.jpeg" alt="hole1"></div>
            <div><img src="hole2.jpeg" alt="hole2"></div>
            <div><img src="hole3.jpeg" alt="hole3"></div>
            <div><img src="hole4.jpeg" alt="hole4" rel="par3"></div>
            <div><img src="hole5.jpeg" alt="hole5"></div>
            <div><img src="hole6.jpeg" alt="hole6" rel="par3"></div>
            <div><img src="hole7.jpeg" alt="hole7"></div>
            <div><img src="hole8.jpeg" alt="hole8"></div>
            <div><img src="hole9.jpeg" alt="hole9"></div>
        </div> -->

        <!-- <div class="modal_pop">
            <div class="bg js-modal-close">

            </div>
            

            <div class="modal_pop_main">
                <h4>いざというときのホールインワン保険！</h4>
                <p>
                    あなたがPar3でホールインワンになる確率は<br>
                    なんとなんとなんと<span class="red">xx%</span>です！<br>
                    いざというときのために
                    <span>ホールインワン保険</span>を申し込んでおきませんか？
                </p>

                <div class="container col-6">
                  <h1 style="text-align: center; margin-top: 2.4rem; margin-bottom: 1.6rem">入力フォーム</h1>
                  <div>
                    <form method="post" action="#" style="width: fit-content; margin: 0 auto;">
                      郵便番号<br />
                      <input type="text" name="zip_code" style="width:100px" id="zip_code">
                      <input type="button" value="住所検索" id="search_address_btn">
                      <input type="button" value="クリア" id="search_clear_btn">
                      <br />
                      都道府県<br />
                      <input type="text" name="address1" style="width:500px" id="address1"><br />
                      市区町村<br />
                      <input type="text" name="address2" style="width:500px" id="address2"><br />
                      その他<br />
                      <input type="text" name="address3" style="width:500px" id="address3"><br />
                      建物名など<br />
                      <input type="text" name="address4" style="width:500px" id="address4"><br />
                      <br />
                      <div class="submit_button_right" style="text-align: right;">
                        <input type="submit"><br />
                      </div>
                    </form>
                  </div>
                </div>
          


                <div class="button012">
                    <a href="#">ホールインワン保険</a>
                </div>
            </div>
        </div> -->

    </body>
</html>
