<!DOCTYPE html>
<html lang="ja">
    <meta charset="UTF-8">
    <head>
        <title>ゴルフアプリ</title>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/bxslider/4.2.12/jquery.bxslider.css">
        <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.4/css/all.css">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
        <script src="https://cdn.jsdelivr.net/bxslider/4.2.12/jquery.bxslider.min.js"></script>
        <link rel="stylesheet" href="index.css">
        
        <!-- 
        <script>

            $(document).ready(function(){
                $('.modal_pop').hide();
                $('.slider').bxSlider({
                    pager: false,
                    controls: false,
                    infiniteLoop: false,
                    onSlideAfter: function($slideElement){
                        if($slideElement.children("img").attr("rel") == "par3"){
                            $('.modal_pop').fadeIn();
                        }   
                    }
                });
                $('.js-modal-close').on('click',function(){
                    $('.modal_pop').fadeOut();
                })
            });
        </script>
        -->

        <script>
            let search = document.getElementById('search');
            search.addEventListener('click', ()=>{
        
                let api = 'https://zipcloud.ibsnet.co.jp/api/search?zipcode=';
                let error = document.getElementById('error');
                let input = document.getElementById('input');
                let address1 = document.getElementById('address1');
                let address2 = document.getElementById('address2');
                let address3 = document.getElementById('address3');
                let param = input.value.replace("-",""); //入力された郵便番号から「-」を削除
                let url = api + param;
        
                fetchJsonp(url, {
                    timeout: 10000, //タイムアウト時間
                })
                .then((response)=>{
                    error.textContent = ''; //HTML側のエラーメッセージ初期化
                    return response.json();  
                })
                .then((data)=>{
                    if(data.status === 400){ //エラー時
                        error.textContent = data.message;
                    }else if(data.results === null){
                        error.textContent = '郵便番号から住所が見つかりませんでした。';
                    } else {
                        address1.value = data.results[0].address1;
                        address2.value = data.results[0].address2;
                        address3.value = data.results[0].address3;
                    }
                })
                .catch((ex)=>{ //例外処理
                    console.log(ex);
                });
            }, false);
          </script>
          
    </head>

    <body>
        
        <form>
            <table>
                <tbody>
                    <tr>
                        <th>郵便番号</th>
                        <td>
                            <input id="input" class="zipcode" type="text" name="zipcode" value="" placeholder="例)8120012">
                            <button id="search" type="button">住所検索</button>
                            <p id="error"></p>
                        </td>
                    </tr>

                    <tr>
                        <th>都道府県</th>
                        <td><input id="address1" type="text" name="address1" value=""></td>
                    </tr>

                    <tr>
                        <th>市区町村</th>
                        <td><input id="address2" type="text" name="address2" value=""></td>
                    </tr>

                    <tr>
                        <th>町域</th>
                        <td><input id="address3" type="text" name="address3" value=""></td>
                    </tr>
                </tbody>
            </table>
        </form>
        
        <!-- 
        <div class="slider">
            <div><img src="hole1.jpeg" alt="hole1"></div>
            <div><img src="hole2.jpeg" alt="hole2"></div>
            <div><img src="hole3.jpeg" alt="hole3"></div>
            <div><img src="hole4.jpeg" alt="hole4" rel="par3"></div>
            <div><img src="hole5.jpeg" alt="hole5"></div>
            <div><img src="hole6.jpeg" alt="hole6" rel="par3"></div>
            <div><img src="hole7.jpeg" alt="hole7"></div>
            <div><img src="hole8.jpeg" alt="hole8"></div>
            <div><img src="hole9.jpeg" alt="hole9"></div>
        </div>
        <div class="modal_pop">
            <div class="bg js-modal-close">

            </div>
            <div class="modal_pop_main">
                <h4>いざというときのホールインワン保険！</h4>
                <p>
                    あなたがPar3でホールインワンになる確率は<br>
                    なんとなんとなんと<span class="red">xx%</span>です！<br>
                    いざというときのために
                    <span>ホールインワン保険</span>を申し込んでおきませんか？
                </p>
                <div class="button012">
                    <a href="#">ホールインワン保険</a>
                </div>
            </div>
        </div>
        -->

    </body>
</html>
